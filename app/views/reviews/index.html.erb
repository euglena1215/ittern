<div class="container">
  <div class="row">
    <div class="col m8 s12">
      <h3>体験談一覧</h3>
    </div>
    <div class="col m4 s12">
      <div class="right">
        <%= link_to '体験談を投稿', new_review_path, class: "btn", style: "margin-top:20px;" %>
      </div>
    </div>
  </div>

  <%= search_form_for @search do |f| %>
  <div class="row">
    <div class="col m6 s12">
      <div class="input-field">
        <%= f.search_field :content_cont %>
        <%= f.label :content_cont, "キーワード検索" %>
      </div>
    </div>
    <div class="col m6 s12">
      <div class="input-field">
      <%= f.select :company_id_eq, options_from_collection_for_select(Company.all, :id, :name), include_blank: "未指定" %>
      <%= f.label :company_id_eq, "企業" %>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col m10 s12">
      <ul class="collapsible" data-collapsible="accordion">
        <li>
          <div class="collapsible-header">
            <i class="material-icons">search</i>
            こだわってみる？
          </div>
          <div class="collapsible-body">
            <div class="input-field">
              <%= f.select :user_id_eq, options_from_collection_for_select(User.all, :id, :name), include_blank: Review.human_attribute_name('user') %>
              <%= f.label :user_id_eq %>
            </div>

            <div class="input-field">
              <%= f.select :rate_eq, (1..5).to_a, include_blank: Review.human_attribute_name('rate') %>
              <%= f.label :rate_eq %>
            </div>

            <div class="input-field">
              <%= f.select :tags_id_eq, options_from_collection_for_select(Review.tag_counts_on(:tags), :id, :name), include_blank: Review.human_attribute_name('tag_list') %>
              <%= f.label :tags_id_eq %>
            </div>

            <div class="row">
              <div class="input-field col s6">
                <div class="input-field">
                  <%= f.select :benefit_transportation_eq, [true, false], include_blank: Benefit.human_attribute_name('transportation') %>
                  <%= f.label :benefit_transportation_eq %>
                </div>
              </div>

              <div class="input-field col s6">
                <div class="input-field">
                  <%= f.select :benefit_accommodation_eq, [true, false], include_blank: Benefit.human_attribute_name('accommodation') %>
                  <%= f.label :benefit_accommodation_eq %>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col s5">
                <div class="input-field">
                  <%= f.search_field :benefit_wage_gteq, placeholder: Benefit.human_attribute_name('wage') %>
                  <%= f.label :benefit_wage_gteq %>
                </div>
              </div>
              <div class="col s2 center-align">
                〜
              </div>
              <div class="col s5">
                <div class="input-field">
                  <%= f.search_field :benefit_wage_lteq, placeholder: Benefit.human_attribute_name('wage') %>
                  <%= f.label :benefit_wage_lteq %>
                </div>
              </div>
            </div>

            <div class="input-field">
              <%= f.select :benefit_lunch_eq, [true, false], include_blank: Benefit.human_attribute_name('lunch') %>
              <%= f.label :benefit_lunch_eq %>
            </div>
          </div>
        </li>
      </ul>
    </div>
    <div class="col m2 s12">
      <%= f.submit class: "btn" %>
    </div>
  </div>
  <% end %>

  <div class="row">
    <% @reviews.each do |review| %>
    <div class="col s12 m6 l4">
      <a href="<%= review_path review %>" style="color:#039be5;">
        <div class="card">
          <div class="card-image" style="background:url(<%= review.company.logo_url %>) no-repeat center center; background-size:contain; height:150px;">
          </div>
          <div class="card-content">
            <span class="card-title"><%= review.company.name %> - <%= review.user.name %></span>
            <p><%= review.tags.pluck(:name).map { |name| "##{name}" }.join(" ") %></p>
          </div>
        </div>
      </a>
    </div>
    <% end %>
  </div>
</div>

<script>
$("document").ready(function() {
  $(".collapsible").collapsible();
  $('select').material_select();
});
</script>
